<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>In qua iframe không bị cảnh báo iOS</title>
  <style>
    #preview-area {
      margin-top: 20px;
      border: 1px solid #ccc;
    }
    #print-frame {
      width: 100%;
      height: 300px;
      border: none;
    }
  </style>
</head>
<body>

  <h2>In hóa đơn</h2>
  <button onclick="renderInvoice()">Xem trước & In</button>
  <div id="preview-area" style="display: none;">
    <h3>Xem trước</h3>
    <iframe id="print-frame"></iframe>
    <br>
    <button onclick="printIframe()">In ngay</button>
  </div>

  <script>
    function renderInvoice() {
      const iframe = document.getElementById('print-frame');
      const doc = iframe.contentWindow.document;

      const html = `
        <html>
          <head>
            <style>
              body { font-family: Arial; padding: 20px; }
              h1 { color: #2c3e50; }
              table { width: 100%; border-collapse: collapse; }
              td, th { border: 1px solid #ccc; padding: 8px; }
            </style>
          </head>
          <body>
            <h1>Hóa đơn bán hàng</h1>
            <p>Ngày: ${new Date().toLocaleDateString()}</p>
            <table>
              <tr><th>Sản phẩm</th><th>Số lượng</th><th>Giá</th></tr>
              <tr><td>Nhớt xe</td><td>1</td><td>120,000đ</td></tr>
              <tr><td>Vệ sinh bugi</td><td>1</td><td>30,000đ</td></tr>
            </table>
            <p><strong>Tổng cộng: 150,000đ</strong></p>
          </body>
        </html>
      `;

      doc.open();
      doc.write(html);
      doc.close();

      // Hiện khung xem trước
      document.getElementById('preview-area').style.display = 'block';
    }

    function printIframe() {
      const iframe = document.getElementById('print-frame');
      iframe.contentWindow.focus();
      iframe.contentWindow.print();
    }
  </script>

</body>
</html>
